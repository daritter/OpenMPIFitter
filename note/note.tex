\documentclass[a4paper]{report}
\usepackage[utf8x]{inputenc}
\usepackage[unicode]{hyperref}
\usepackage{hepnames}
\usepackage{graphicx}
\usepackage{microtype}
\usepackage{sistyle}
\usepackage{amsmath}
\usepackage{array}
\usepackage{booktabs}
\input{macros.tex}

\def\BMultiplicity{1.4}
\def\MassWLimit{\SI{90}{\%}}
\def\BestBSelectionEff{\SI{89}{\%}}
\def\CorrectRecoEff{\SI{91}{\%}}

\def\ReconstructedBR{\num{2.851e-02}}
\def\RawReconstructionEffSVDOne{(2.028 \pm 0.018) \times 10^{-3}}
\def\RawReconstructionEffSVDTwo{(7.656 \pm 0.036) \times 10^{-3}}
\def\ReconstructionEffSVDOne{(5.780 \pm 0.052) \times 10^{-5}}
\def\ReconstructionEffSVDTwo{(21.825 \pm 0.102) \times 10^{-5}}

\arraycolsep0pt

\begin{document}
\chapter{Event Selection}
\section{Data Sample}
Full Belle dataset, \SI{772e6}{\bbar~pairs}
\section{Event Generation}
To be able to analyze the data we have to form an expectation on how the \ddk
decay will behave by simulating \ddk events. This signal Monte Carlo (MC)
production occurs in two stages. Firstly, the physical decay process is
simulated using EvtGen\cite{evtgen}. In a second step the response of the Belle
detector is modelled with GEANT\cite{geant3}, a software package designed to
simulate interactions between particles and matter. GEANT traces the particles
provided by EvtGen through a simulated detector and returns a signal event
resembling a real detector output.

The signature of \ddk decays may differ for both versions of the SVD, so signal
MC was generated under both, SVD1 and SVD2 conditions. A set of \num{6e6} events
was simulated for each SVD.

For the generated events, one \PB meson decays generically and the other decays
exclusively into \ddk where the products will continue to decay as seen in Table
\ref{tab:gen-decay}

\begin{table}[h]
    \centering
    \begin{tabular}{lLrr}
        \toprule
        \multicolumn{2}{l}{Decay}& relative \BR & generated \BR\\
        \midrule
        \PBz   &\rightarrow \PDstp\PDstm\PKzS + \text{cc}&\SI{0.41}{\%}&\SI{100.00}{\%}\\
        \midrule
        \PDstp &\rightarrow \PDz\Pgpps + \text{cc} &\SI{67.70}{\%}&\SI{68.80}{\%}\\
        &\rightarrow \PDp\Pgpzs + \text{cc}&\SI{30.70}{\%}&\SI{32.20}{\%}\\
        \midrule
        \PDz   &\rightarrow \PKm\Pgpp + \text{cc}&\SI{3.87}{\%}&\SI{15.03}{\%}\\
        &\rightarrow \PKm\Pgpp\Pgpz + \text{cc}&\SI{13.90}{\%}&\SI{53.71}{\%}\\
        &\rightarrow \PKm\Pgpp\Pgpp\Pgpm + \text{cc}&\SI{8.07}{\%}&\SI{31.26}{\%}\\
        \midrule
        \PDp   &\rightarrow \PKm\Pgpp\Pgpp + \text{cc}&\SI{9.13}{\%}&\SI{100.00}{\%}\\
        \midrule
        \PKzS  &\rightarrow \Pgpp\Pgpm &\SI{69.20}{\%} &\SI{100.00}{\%}\\
        \bottomrule
    \end{tabular}
    \caption{Real branching fractions and generated branching fractions for the
    signal \PBz}
    \label{tab:gen-decay}
\end{table}

\section{\bbar Event Selection}
Default HadronB/HadronBJ skim

\section{Track Selection}
\label{sec:trackselection}

In this Analysis we differ between two distinct classes of pions: normal pions
used in the reconstruction of \PD and \PKzS mesons and slow pions which are used
to reconstruct \PDst mesons. For two classes of pions are in a very different
momentum range so that we have to apply different cuts to them.

A loose selection criteria is applied to reject poorly reconstructed tracks,
\begin{align*}
    dr <& \SI{0.4}{cm}& |dz| <&\SI{5}{cm}
\end{align*}
where $dr$ and $|dz|$ represent the distance of closest approach between the
track and the IP in the $xy$ plane and the $z$-direction respectively. \ddk
contains many tracks with relatively low momentum which typically leads to a
poorer track resolution. However, to achieve the best $\Delta t$ resolution only
tracks with a minimal amount of hits in the SVD are accepted for vertexing of
\PD and \PBz mesons.
\begin{align*}
    1\times r\phi \text{ hit}&& 2\times z \text{ hit}
\end{align*}

Since two slow pions with very low momentum are required for the reconstruction
of each event, an extra tracking algorithm which tries to reconstruct tracks
only from hits in the SVD is enabled for this analysis. However to reduce the
background these tracks are not taken into account for the reconstruction of
\PD mesons as those tracks have high enough momentum that the SVD only tacking
does not give significant improvement.

No cut on $dr$ and $|dz|$ is performed and no SVD hits are required for slow
pion tracks but the momentum of those tracks is restricted to
\[ p(\Pgppms) < \SI{0.3}{GeV/c} \]

\section{Particle Identification}

Pions and kaons cannot be distinguished unambiguously. However, the
sub-detectors are able to provide a likelihood that a charged track is one or
the other, so the likelihood ratio is constructed,
\[
\mathcal{P}\left( \PK : \Pgp \right) =
\frac{\LH_{\PK}}{\LH_{\PK} +
\LH_{\Pgp}}
\]
where $\mathcal{P}\left( \PK : \Pgp \right)$ is the likelihood that a track is a
kaon compared against a pion hypothesis. $\LH_i$ $(i = \PK, \Pgp)$ is
the likelihood that the particle is of type $i$ and is calculated as
\[ \LH_i = \LH_i^{CDC} \times \LH_i^{TOP} \times \LH_i^{ACC} \]
where eac component $\LH_i^{DET}$ is the likelihood that the particle is of type
$i$ in the respective subdetector.

%FIXME: Plot of P

For a track to be accepted as a pion it must statisfy
\[ \mathcal{P}\left( \PK : \Pgp \right) < 0.9 \]
which means the track will be accepted as a pion unless there is a greater than
\SI{90}{\%} likelihood that the track is a kaon. For a track to be accepted as a
kaon
\[ \mathcal{P}\left( \PK : \Pgp \right) > 0.1 \]

This cuts are quite loose and therefore there is a region of overlap where
tracks can be considered to be both, a pion and a kaon.

No PID cut is applied for slow pion tracks.

\section{CP Side Reconstruction}

\subsection{\texorpdfstring{\Pgpz}{pi0}}
The \Pgpz is reconstructed as
\[\Pgpz \rightarrow \Pgg\Pgg\]
and is subject to the following cuts:
\[ E_{\Pgg} > \SI{0.03}{GeV} \]
\begin{align*}
    p(\Pgpz) >& \SI{0.2}{GeV/c}&
    p(\Pgpzs)<& \SI{0.3}{GeV/c}
\end{align*}
where $E_{\Pgg}$ is the energy of each \Pgg  and $p(\Pgpz)$ the momentum of the
reconstructed \Pgpz, both in the laboratory frame. This cuts help to reduce the
effects of misreconstruction. An additional cut on the invariant mass was
applied which will be discussed in Section \ref{sec:masscuts}

\subsection{\texorpdfstring{\PKzS}{K0S}}

\subsection{\texorpdfstring{\PDz and \PDpm}{D0 and D+-}}
\PDz and \PDpm mesons are reconstructed by combining pion and kaon tracks
according to Table \ref{tab:gen-decay} and applying a cut on the invariant mass.
This cut will be discussed in Section \ref{sec:masscuts}.

A vertex fit is performed on the resulting \PD candidate to get the optimal
vertex resolution.  For this vertex fit all charged tracks which are suitable
for vertexing (see Section \ref{sec:trackselection}) are fitted on a common
vertex and all other tracks are constrained to originate from the same vertex.
Then a new \PD momentum is calculated using the updated track information.

\subsection{\texorpdfstring{\PDstpm}{D*+-}}
The \PDstpm is reconstructed from a \PD meson and a slow pion. As mentioned, the
\Pgppms is not subject to PID or track quality cuts and also the \Pgpzs is not
to the \Pgpz momentum threshold cut. Both, \Pgppms and \Pgpzs are required to
have a momentum smaller than \SI{0.3}{GeV/c}. In the case of \PDstpm it is
better to cut on the mass difference between the reconstructed \PDstpm and the
daughter \PD meson as the resolution of the resulting distribution is much
better. The cut on the mass difference will be explained in more detail in
Section \ref{sec:masscuts}.

The lifetime of the \PDstpm is less than \SI{10^{-23}}{s} so we can safely
assume its vertex position to be identical with that of the daughter \PD meson.
Since the momentum resolution of the slow pions is poor compared to the tracks
used to reconstruct the \PD vertex we do not perform a vertex fit at this point
as it would only worsen the vertex resolution.

\subsection{\texorpdfstring{\PBz}{B0}}

Now we can reonstruct \ddk. The B vertex is determined by fitting only the
granddaughter \PD pseudo tracks for which the vertex fit was successful. The
\PKzS is excluded due to it's long flight length. The vertex resolution can be
improved by including the IP position in the vertex fit which is typically
\SI{100}{µm} in $x$, \SI{5}{µm} in $y$ and \SI{4}{mm} in $z$. To account for the
finite flight length of the \PB meson, the IP profile is smeared in the
$xy$ plane:
\[ \text{IP}_{\text{smear}} = \SI{21}{µm} \]

After the vertex fit the excluded \PKzS and the slow pions are constrained to
come from the same vertex and the \PBz momentum is calculated using these
updated momenta.

Due to the combinatorial nature of the reconstruction there is a possibility
that more than one \PBz can be reconstructed per Event. This is called
multiplicity and for signal MC the multiplicity is \BMultiplicity per event.
However, there can only be one reconstructed \ddk per event so it is necessary
to choose the best candidate using the so called ``Best \PB'' selection which
will be detailed in Section \ref{sec:bestB}.

An \PBz is considered ``correct'' in signal MC when all tracks which were used
to determine the vertex can be matched to a corresponding generated particle,
thus the \PKzS, the slow pions and any \Pgpz are not required to be correctly
reconstructed. This results in a correct reconstruction efficiency, meaning the
fraction of reconstructed \PBz which are considered correct, of
\CorrectRecoEff on signal MC.

\subsection{Invariant Mass Windows}
\label{sec:masscuts}

To avoid systematic uncertainties due to a possible difference between MC and
real data the invariant mass windows for \Pgpz, \PKzS, \PD and \PDstpm were
determined from an inclusive data sample. $10^6$ events from where sampled from
the complete Belle data set where number of events taken per run was scaled
according to the luminosity of that run. Reconstruction was performed identical
to the analysis reconstruction described so far but only up to and including
\PDstpm reconstruction using very wide mass windows in all channels.

The invariant mass of the particles is then modeled using
\[
P(m) = f_{sig} * \LH_{sig}(m) + (1-f_{sig}) \LH_{bkg}(m)
\]
where $\LH_{bkg}(m)$ is either a linear function in case of \Pgpz, \PKzS or \PD
or a threshold function in case of \PDstpm and $\LH_{sig}(m)$ is a sum of
Gaussian distributions
\[
\begin{array}{rll}
    \LH_{sig}(m) &= \sum_i^N G(\sigma_i,\mu_i)&\\
    \LH_{bkg}(m) &= p_0 \cdot m + p_1&\text{ for \Pgpz, \PKzS or \PD}\\
    \LH_{bkg}(m) &= m^{p_0} \cdot e^{p_1m+p_2m^2}&\text{ for \PDstpm}
\end{array}
\]
The mass window is then determined from this distributions by taking the
symmetric area around the mean of the narrowest Gaussian which contains
\MassWLimit\ of the area of $\LH_{sig}(m)$

%FIXME: plot, table

\subsection{Best \texorpdfstring{\PB}{B} Selection}
\label{sec:bestB}
For the Best \PB selection we use the signal likelihoods defined above to
construct a likelihood for the \PB candidate:
\[
\LH_{\PBz} = \LH_{sig}^{\PDstp} \times \LH_{sig}^{\PD_{(+)}} \times \LH_{sig}^{\PDstm} \times
\LH_{sig}^{\PD_{(-)}} \times \LH_{sig}^{\PKzS}
\]
where $\PD_{(\pm)}$ denotes to the daughter \PD of the corresponding \PDstpm and
can either be a \PDz or \PDpm depending on the reconstruction chain. The \PB
candidate with the larges likelihood is taken as the correct \PB candidate. On
signal MC this procedure results in the selected \PB candidate to be the correct
one \BestBSelectionEff\ of the time.

%FIXME: plots of Dstp lhood

\section{Tagside Reconstruction}

After successful reconstruction of the CP side all remaining tracks should
belong to the other \PB meson. The vertex and the flavour of the $\PB_{tag}$ are
determined using the standard Belle tools.

\section{Control Sample}

\chapter{Branching Fraction}

\section{Reconstruction Efficiency}

The raw reconstruction efficiency can be obtained easily by counting the number
of events which were reconstructed correctly and divide it by the number of
total simulated events
\begin{align}
    \epsilon_{raw}^{\text{(SVD1)}} & = \RawReconstructionEffSVDOne &
    \epsilon_{raw}^{\text{(SVD2)}} & = \RawReconstructionEffSVDTwo
\end{align}

However, not all possible decays for \ddk are reconstructed. In fact, only a
very small fraction of those decays can be reconstructed efficiently. However in
the signal MC we only simulated decays we actually reconstruct and thus we
have to weight the raw reconstruction efficiency with the total reconstructed
Branching ratio for \ddk. Given the reconstructed Branching ratio for \PDst
\begin{align}
    \BR_{rec}\big(\PDstp \rightarrow \PDz\Pgpps\big) &=
    \BR\big(\PDstp \rightarrow \PDz\Pgpps\big) \times \sum_i \BR\big(\PDz_i\big)\\
    \BR_{rec}\big(\PDstp \rightarrow \PDp\Pgpzs\big) &=
    \BR\big(\PDstp \rightarrow \PDp\Pgpzs\big) \times \sum_i \BR\big(\PDp_i\big)
\end{align}
where $\PDp_i$ and $\PDz_i$ denote to the $i$th reconstructed decay channel for
the \PD meson and assuming the same branching ratio for the charge conjugated
decays it follows that
\begin{multline}
    \BR_{rec}\big(\ddk\big) = \\
    \BR\big(\PKzS \rightarrow \Pgpp\Pgpm \big) \times
    \Big(
    \BR_{rec}\big(\PDstp \rightarrow \PDz\Pgpps\big)
    + \BR_{rec}\big(\PDstp
    \rightarrow \PDp\Pgpzs\big)
    \Big)^2
\end{multline}
and with the individual branching ratios given in Table \ref{tab:gen-decay} the
total reconstructed branching ratio is
\begin{equation}
    \BR_{rec}\big(\ddk\big) = \ReconstructedBR
\end{equation}
and the total reconstruction efficency is
\begin{align}
    \epsilon_{MC}^{\text{(SVD1)}} & = \ReconstructionEffSVDOne &
    \epsilon_{MC}^{\text{(SVD2)}} & = \ReconstructionEffSVDTwo
\end{align}


\end{document}
